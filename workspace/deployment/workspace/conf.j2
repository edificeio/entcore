{
    "name": "{{ entcoreWorkspaceVersion }}",
    "priority": 55,
    "config": {
        "main": "org.entcore.workspace.Workspace",
        "auto-redeploy": false,
        "mode": "{{ envMode|default('prod') }}",
        "wsPort": 6502,
        {% if csrfToken %}"csrf-token": true,{% endif %}
        "ssl": {{ enableSsl|default(true) }},
        {% if overrideTheme %} "override-theme": {}, {% endif %}
        "app-type" : "END_USER",
        "host": "https://{{ host }}",
        "neo4jPlugin": true,
        "userbook-host": "https://{{ host }}",
        "app-name": "Espace documentaire",
        "app-address": "/workspace/workspace",
        "app-icon": "workspace-large",
        "port": 8011,
        "old-query": {{ workspaceUseOldQuery|default('false') }},
        "mongo-address": "wse.mongodb.persistor",
        {% if fileAnalyzerOn %}
        "fileAnalyzer": {
          "enabled": true,
          "messaging": {
            "type": "redis",
            "stream": "xss-analyzer",
            "tags": ["xss-analyzer", "workspace"],
            "consumer-block-ms": 0,
            "consumer-name": "xss-analyzer-workspace-{{ ansible_fqdn|default('app') }}",
            "consumer-group": "xss-analyzer-workspace-group",
            "metrics": {
              "enabled": true
            }
          },
          "mime-types": {{ fileAnalyzerMimeTypes|default('[".*image/svg.*"]') }},
          "max-size": 20000000
        },
        {% endif %}
		{% if scratchUrl is defined %} "enable-scratch": true, {% endif %}
        {% if loolVersion is defined %}"enable-lool": true,{% endif %}
        {% if geogebraVersion is defined %}"enable-geogebra": true,{% endif %}
        {% if nextcloudVersion is defined %}"enable-nextcloud": true,{% endif %}
        "publicConf": {
            "lazy-mode": {{ workspaceLazyMode|default('true') }},
            "ttl-documents":{{ workspaceTtlDoc|default('180') }},
            "ttl-folders":{{ workspaceTtlFolder|default('600') }},
			{% if nextcloudVersion is defined %}"folder-service": ["nextcloud"],{% endif %}
            "xiti": {
                "ID_SERVICE": {
                    "default": 1
                },
                "LIBELLE_SERVICE": {
                    "default": "STOCKAGE_PARTAGE"
                }
            }
        }
    }
}