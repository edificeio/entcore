<!DOCTYPE html>
<!--

 -->

<html>

<head>
	<title>{{#i18n}}workspace.title{{/i18n}}</title>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
	<script type="text/javascript" src="/workspace/public/dist/entcore/ng-app.js" id="context"></script>
	<script type="text/javascript" src="/workspace/public/dist/application.js"></script>

	<script type="text/ng-template" id="folder-content">
			<span ng-class="{'highlight-title-3s':isHighlightTree(folder),'ng-hide':!isHighlightTree(folder)}" class="highlight-title">
				<span class="count-badge">[[getHighlightCount(folder)]]</span>
			</span>
			<a ng-class="{ selected: isSelectedFolder(folder), opened: isOpenedFolder(folder) }" ng-click="openFolderRoute(folder)" ng-if="folder.name !== undefined"
			   class="folder-list-item"
			   dragdrop="dropTo(folder, $originalEvent)"
			   dropcondition="dropCondition(folder)"
			   help-box-step="[[folder.helpbox]]">
				<i class="arrow" ng-if="canExpendTree(folder)"></i> [[folder.name]]
			</a>
			<ul data-ng-class="{ selected: isOpenedFolder(folder), closed: !isOpenedFolder(folder) }" ng-if="isOpenedFolder(folder)">
				<li data-ng-repeat="folder in folder.children" data-ng-include="'folder-content'" class="highlight-title-wrapper"></li>
			</ul>
		</script>
	<!--TODO move to infrafront cssutils, pictos.scss ....-->
	<style>
		.spinner:before {
			content: "\e85a";
		}

		@keyframes hightlight-border {
			0% {
				border: 0px solid #FF8500;
				box-shadow: none;
			}
			10% {
				border: 1px solid #FF8500;
				box-shadow: 0px 0px 25px #FF8500;
			}
			90% {
				border: 1px solid #FF8500;
				box-shadow: 0px 0px 25px #FF8500;
			}
			100% {
				border: 0px solid #FF8500;
				box-shadow: none;
			}
		}

		.highlight-border-3s {
			animation: hightlight-border 3s ease-in-out 0ms 1;
			border-radius: 20px;
		}

		.highlight-border-3s * {
			border: none !important;
		}

		.dropzone-overlay-wrapper {
			position: relative !important;
			box-shadow: none;
			border: none;
		}

		.dropzone-overlay {
			position: absolute !important;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			outline: 2px dashed #FF8500;
			background: rgba(250, 250, 250, 0.4);
			z-index: 99;
		}

		.message-box {
			box-shadow: 1px 1px 5px rgba(0, 0, 0, 0.3);
			border-radius: 5px;
			overflow: hidden;
			transition: 500ms ease;
			box-sizing: border-box;
			border: none;
			background: white;
			z-index: 999;
		}
		.justified-text{
			text-align: justify;
		}

		/*HELPBOX*/
		.helpbox-highlight-message{
			box-shadow: 0 0 0 99999px rgba(0, 0, 0, 0.7);
			z-index: 98;
			position: relative;
		}
		.helpbox-highlight {
			z-index: 99;
			position: relative;
			background: white;
		}

		.workspace-share button.sharing-button {
			position: absolute;
			top: -60px;
			right: 0;
		}

		explorer.radius a,
		explorer.radius img {
			border-radius: 20px;
		}

		explorer.radius legend {
			border-bottom-left-radius: 20px;
			border-bottom-right-radius: 20px;
		}

		article.icons-view>div {
			height: 100%;
			overflow-y: scroll;
		}

		article.list-view {
			height: calc(100vh - 250px);
			overflow-y: scroll;
		}

		table.sticky-header thead tr th,
		table.sticky-header thead tr td {
			background: #4bafd5;
			color: #fff;
			border: none;
			position: sticky;
			top: 0;
			z-index: 10;
		}

		table th .sortable {
			display: flex;
			flex-direction: row;
			align-items: center;
		}

		table th .sortable .icons {
			display: flex;
			flex-direction: column;
			float: left;
		}

		table th .sortable .icons i {
			margin: 0;
			height: 18px;
		}

		table th .sortable .icons i.arrow:before {
			font-size: 10px;
		}

		.icon-off {
			opacity: 0.3;
		}

		.arrow.bottom {
			transform: rotate(180deg);
			display: inline-block;
		}

		table.darkgrey tbody tr *,
		table.darkgrey tbody tr.checked *,
		table.darkgrey tbody tr.checked:hover * {
			color: #333333;
			/*darkest-grey*/
		}

		table.primary-hover tbody tr:hover * {
			color: #FF8500;
		}
		.height-minus200 {
			height: calc(100vh - 200px);
			overflow-y: scroll;
		}
		.height-minus300 {
			height: calc(100vh - 300px);
			overflow-y: scroll;
		}
		.height-minus200.no-overflow{
			overflow: hidden;
		}
		.height-minus300.no-overflow{
			overflow: hidden;
		}
		.maxheight-minus450 {
			max-height: calc(100vh - 450px);
			overflow-y: scroll;
		}
		.maxheight-minus400 {
			max-height: calc(100vh - 400px);
			overflow-y: scroll;
		}
		.maxheight-minus350 {
			max-height: calc(100vh - 350px);
			overflow-y: scroll;
		}
		.maxheight-half-vh {
			max-height: 50vh;
			overflow-y: scroll;
		}

		.flex-one {
			flex: 1;
		}

		.disabled-color,
		i.disabled-color::before {
			color: #9F9F9F !important
		}

		.zoomout-2x {
			transform: scale(0.5)
		}

		.overflowx-hd {
			overflow-x: hidden !important;
		}
		.overflowy-hd {
			overflow-y: hidden !important;
		}

		/**
		* Highlight title in nav with count
		**/
		nav.vertical .highlight-title .count-badge {
			display: block;
			position: relative;
			width: 20px;
			height: 20px;
			top: -12px;
			left: calc(100% - 12px);
			border-radius: 100%;
			text-align: center;
			font-size: 12px;
			line-height: 20px;
			background: orange;
			color: white;
		}

		nav.vertical .highlight-title {
			display: block;
			position: absolute;
			left: 20px;
			top: 0px;
			width: calc(100% - 70px);
			border-radius: 6px;
			padding-top: 2px;
			padding-bottom: 2px;
		}

		nav.vertical ul li.highlight-title-wrapper {
			position: relative;
		}


		@keyframes hightlight-title {
			0% {
				border: 0px solid #FF8500;
			}
			10% {
				border: 2px solid #FF8500;
			}
			90% {
				border: 2px solid #FF8500;
			}
			100% {
				border: 0px solid #FF8500;
			}
		}

		nav.vertical .highlight-title-3s {
			animation: hightlight-title 3s ease-in-out 0ms 1;
		}
		.centered-bloc-text{
			display: block;
			text-align: center;
		}
		.cursor-notallowed{
			cursor: not-allowed;
		}
		.no-padding-bottom{
			padding-bottom: 0px;
		}
		.workspace-app .material .main{
			padding-bottom: 0;
		}
		.workspace-app .toggle-buttons-spacer{
			margin-bottom: 0px;
		}
	</style>
</head>

<body data-ng-controller="Workspace" bottom-scroll="incrementVisibleFiles()" class="workspace-app">
	<portal>
		<div class="row">
			<app-title class="twelve">
				<h1 class="cell right-spacing-twice" data-reload help-box-step="workspace.help.1" help-box-step-priority="-1">
					<i class="storage"></i><i18n>workspace.headers</i18n>
				</h1>
			</app-title>
		</div>
		<div class="row rigid-grid">
			<section class="four twelve-mobile cell">
				<!--IMPORT DESKTOP-->
				<div class="row zero-mobile" ng-repeat="button in currentTree.buttons">
					<button ng-click="button.action()" ng-disabled="button.disabled()" workflow="[[button.workflow]]">
						<i class="add" ng-if="button.icon"></i> [[button.text]]
					</button>
				</div>
				<nav class="vertical mobile-navigation top-spacing-twice" side-nav>
					<div data-ng-repeat="folder in wrapperTrees" data-ng-include="'folder-content'" class="folder-tree maxheight-minus350 maxheight-minus400-1d overflowx-hd"></div>
					<a ng-click="openNewFolderView()" ng-if="canCreateNewFolder()" class="classic-link centered-bloc-text vertical-spacing-twice-1d"><i18n>folder.new</i18n></a>
					<a ng-click="openNewFolderView()" ng-if="canCreateNewFolderShared()" class="classic-link centered-bloc-text vertical-spacing-twice-1d"><i18n>folder.new.shared</i18n></a>
					<a ng-click="emptyTrash()" ng-if="canEmptyTrash()" class="classic-link centered-bloc-text vertical-spacing-twice-1d"><i18n>workspace.empty.trash</i18n></a>
					<div class="row">
						<h2>
							<i18n>quota.title</i18n>
						</h2>
						<progress-bar max="quota.max" filled="quota.used" unit="[[quota.unit]]"></progress-bar>
						<hr class="row" />
					</div>
				</nav>


			</section>
			<section class="margin-four">
				<h3 whereami></h3>
				<nav class="twelve cell">
					<div class="row">
						<!--IMPORT MOBILE-->
						<div class="zero-desktop six-mobile" ng-repeat="button in currentTree.buttons">
							<button ng-click="button.action(button.url)" workflow="[[button.workflow]]">
								<i class="add" ng-if="button.icon"></i> [[translate(button.text)]]
							</button>
						</div>
						<!--SEARCH DESKTOP-->
						<div class="cell four six-1d search-pagination zero-mobile">
							<a ng-class="{'show-close':canResetSearch()}" ng-show="canResetSearch()" ng-click="resetSearch()"><i class="close horizontal-spacing cell-ellipsis"></i></a>
							<input ng-class="{'eleven':canResetSearch(),'twelve':!canResetSearch()}" type="text" ng-model="search.criteria" ng-keyup="searchKeyUp($event)"
							 i18n-placeholder="workspace.search.placeholder">
							<i class="search" ng-click="searchSubmit()"></i>
						</div>
						<!--VIEW MODE-->
						<div class="cell right-magnet">
							<i class="show-list" ng-class="{ selected: isViewMode('list') }" ng-click="changeViewMode('list')"></i>
							<i class="show-icons" ng-class="{ selected: isViewMode('icons') }" ng-click="changeViewMode('icons')"></i>
							<i class="show-carousel" ng-class="{ selected: isViewMode('carousel') }" ng-click="changeViewMode('carousel')"></i>
						</div>
						<!--SEARCH MOBILE-->
						<div class="zero-desktop cell four search-pagination twelve-mobile vertical-spacing-twice">
							<a ng-class="{'show-close':canResetSearch()}" ng-show="canResetSearch()" ng-click="resetSearch()"><i class="close horizontal-spacing cell-ellipsis"></i></a>
							<input ng-class="{'eleven':canResetSearch(),'twelve':!canResetSearch()}" type="text" ng-model="search.criteria" ng-keyup="searchKeyUp($event)"
							 i18n-placeholder="workspace.search.placeholder">
							<i class="search" ng-click="searchSubmit()"></i>
						</div>
					</div>
					<div class="row top-spacing-twice notification primary-color" ng-if="showSearchOptions()">
						<label class=""><input type="checkbox" ng-model="search.everywhere" ng-change="searchSubmit()">
							<span><i18n>workspace.search.inworkspace</i18n></span>
						</label>
					</div>
					<div class="row top-spacing-three notification primary-color " ng-if="showSearchResultForFolder()">
						<label class="cell top-spacing-twice">
							<i18n>workspace.search.results.infolder</i18n> "[[currentFolderName()]]"
						</label>
						<div class="is-light cell left-spacing-four" ng-click="searchInWorkspace()"><label><i18n>workspace.search.inworkspace</i18n></label></div>
					</div>
					<div class="row top-spacing-three notification primary-color " ng-if="showSearchResultForWorkspace()">
						<label class="cell top-spacing-twice">
							<i18n>workspace.search.results.inworkspace</i18n>
						</label>
					</div>
				</nav>
				<div class="twelve cell toggle-buttons-spacer">
					<container template="documents" ng-hide="isSearching()"></container>
					<div class="flex-row top-spacing-four" ng-show="isSearching()">
						<div class="centered top-spacing-four">
							<div class="top-spacing-four notification primary-color">
								<label class=""><i18n>workspace.search.inprogress</i18n></label><i class="spinner left-spacing"></i>
							</div>
						</div>
					</div>
				</div>
			</section>
		</div>
	</portal>
	<container template="lightboxes"></container>
	<container template="toaster"></container>
	<help-box can-close="false" direction="right" title="workspace.help.title" display="[[display.quickStart]]" on-finished="onQuickstartFinished()"></help-box>
</body>

</html>