{"version":3,"file":"mathjax.cjs","sources":["../../src/mathjax/mathjax.ts"],"sourcesContent":["import { Node } from '@tiptap/core';\n\nexport const MathJax = Node.create({\n  name: 'mathjaxnode',\n  group: 'inline',\n  inline: true,\n  atom: false,\n  selectable: true,\n\n  parseHTML() {\n    return [\n      {\n        tag: 'mathjax',\n      },\n    ];\n  },\n\n  addAttributes() {\n    return {\n      equation: {\n        default: null,\n        parseHTML: (element: any) => {\n          const children = [...element.childNodes];\n          const textNodes = children.filter((child) => child.nodeType === 3);\n          return textNodes.length > 0\n            ? textNodes[textNodes.length - 1].nodeValue\n            : null;\n        },\n      },\n    };\n  },\n\n  renderHTML({ HTMLAttributes }) {\n    let equation = (HTMLAttributes.equation || '')\n      // Get what is between \\begin{equation}{... ...}\\end{equation}\n      // Or between  \\begin{equation}... ...\\end{equation} without enclosing brackets\n      .replaceAll(\n        /(?:\\\\)?begin{equation}\\s*\\n?\\s*{(.+?)}\\n?\\s*?(?:\\\\)?end{equation}/gm,\n        '$$$1$$',\n      )\n      .replaceAll(\n        /(?:\\\\)?begin{equation}\\s*\\n?\\s*(.+?)\\n?\\s*?(?:\\\\)?end{equation}/gm,\n        '$$$1$$',\n      );\n    if (equation.length > 0) {\n      if (equation.charAt(0) !== '$') {\n        equation = `$${equation}`;\n      }\n      if (equation.charAt(equation.length - 1) !== '$') {\n        equation = `${equation}$`;\n      }\n    }\n    return ['span', {}, equation];\n  },\n});\n"],"names":["Node"],"mappings":"mHAEa,QAAUA,UAAK,OAAO,CACjC,KAAM,cACN,MAAO,SACP,OAAQ,GACR,KAAM,GACN,WAAY,GAEZ,WAAY,CACH,MAAA,CACL,CACE,IAAK,SAAA,CAET,CACF,EAEA,eAAgB,CACP,MAAA,CACL,SAAU,CACR,QAAS,KACT,UAAY,SAAiB,CAE3B,MAAM,UADW,CAAC,GAAG,QAAQ,UAAU,EACZ,OAAQ,OAAU,MAAM,WAAa,CAAC,EAC1D,OAAA,UAAU,OAAS,EACtB,UAAU,UAAU,OAAS,CAAC,EAAE,UAChC,IAAA,CACN,CAEJ,CACF,EAEA,WAAW,CAAE,gBAAkB,CACzB,IAAA,UAAY,eAAe,UAAY,IAGxC,WACC,sEACA,QAAA,EAED,WACC,oEACA,QACF,EACE,OAAA,SAAS,OAAS,IAChB,SAAS,OAAO,CAAC,IAAM,MACzB,SAAW,IAAI,QAAQ,IAErB,SAAS,OAAO,SAAS,OAAS,CAAC,IAAM,MAC3C,SAAW,GAAG,QAAQ,MAGnB,CAAC,OAAQ,CAAC,EAAG,QAAQ,CAAA,CAEhC,CAAC"}