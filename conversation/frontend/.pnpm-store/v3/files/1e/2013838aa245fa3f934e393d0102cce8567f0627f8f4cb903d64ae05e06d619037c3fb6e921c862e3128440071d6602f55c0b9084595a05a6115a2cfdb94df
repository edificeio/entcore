{"version":3,"file":"mathjax.js","sources":["../../src/mathjax/mathjax.ts"],"sourcesContent":["import { Node } from '@tiptap/core';\n\nexport const MathJax = Node.create({\n  name: 'mathjaxnode',\n  group: 'inline',\n  inline: true,\n  atom: false,\n  selectable: true,\n\n  parseHTML() {\n    return [\n      {\n        tag: 'mathjax',\n      },\n    ];\n  },\n\n  addAttributes() {\n    return {\n      equation: {\n        default: null,\n        parseHTML: (element: any) => {\n          const children = [...element.childNodes];\n          const textNodes = children.filter((child) => child.nodeType === 3);\n          return textNodes.length > 0\n            ? textNodes[textNodes.length - 1].nodeValue\n            : null;\n        },\n      },\n    };\n  },\n\n  renderHTML({ HTMLAttributes }) {\n    let equation = (HTMLAttributes.equation || '')\n      // Get what is between \\begin{equation}{... ...}\\end{equation}\n      // Or between  \\begin{equation}... ...\\end{equation} without enclosing brackets\n      .replaceAll(\n        /(?:\\\\)?begin{equation}\\s*\\n?\\s*{(.+?)}\\n?\\s*?(?:\\\\)?end{equation}/gm,\n        '$$$1$$',\n      )\n      .replaceAll(\n        /(?:\\\\)?begin{equation}\\s*\\n?\\s*(.+?)\\n?\\s*?(?:\\\\)?end{equation}/gm,\n        '$$$1$$',\n      );\n    if (equation.length > 0) {\n      if (equation.charAt(0) !== '$') {\n        equation = `$${equation}`;\n      }\n      if (equation.charAt(equation.length - 1) !== '$') {\n        equation = `${equation}$`;\n      }\n    }\n    return ['span', {}, equation];\n  },\n});\n"],"names":[],"mappings":";AAEa,MAAA,UAAU,KAAK,OAAO;AAAA,EACjC,MAAM;AAAA,EACN,OAAO;AAAA,EACP,QAAQ;AAAA,EACR,MAAM;AAAA,EACN,YAAY;AAAA,EAEZ,YAAY;AACH,WAAA;AAAA,MACL;AAAA,QACE,KAAK;AAAA,MAAA;AAAA,IAET;AAAA,EACF;AAAA,EAEA,gBAAgB;AACP,WAAA;AAAA,MACL,UAAU;AAAA,QACR,SAAS;AAAA,QACT,WAAW,CAAC,YAAiB;AAE3B,gBAAM,YADW,CAAC,GAAG,QAAQ,UAAU,EACZ,OAAO,CAAC,UAAU,MAAM,aAAa,CAAC;AAC1D,iBAAA,UAAU,SAAS,IACtB,UAAU,UAAU,SAAS,CAAC,EAAE,YAChC;AAAA,QAAA;AAAA,MACN;AAAA,IAEJ;AAAA,EACF;AAAA,EAEA,WAAW,EAAE,kBAAkB;AACzB,QAAA,YAAY,eAAe,YAAY,IAGxC;AAAA,MACC;AAAA,MACA;AAAA,IAAA,EAED;AAAA,MACC;AAAA,MACA;AAAA,IACF;AACE,WAAA,SAAS,SAAS,MAChB,SAAS,OAAO,CAAC,MAAM,QACzB,WAAW,IAAI,QAAQ,KAErB,SAAS,OAAO,SAAS,SAAS,CAAC,MAAM,QAC3C,WAAW,GAAG,QAAQ,OAGnB,CAAC,QAAQ,CAAC,GAAG,QAAQ;AAAA,EAAA;AAEhC,CAAC;"}