!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@tiptap/core"),require("@tiptap/pm/state"),require("@tiptap/pm/view"),require("katex")):"function"==typeof define&&define.amd?define(["exports","@tiptap/core","@tiptap/pm/state","@tiptap/pm/view","katex"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self)["@tiptap-pro/extension-mathematics"]={},e.core,e.state,e.view,e.katex)}(this,(function(e,t,i,o,n){"use strict";function a(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var s=a(n);const r=e=>{const{regex:t,katexOptions:n={}}=e;return new i.Plugin({key:new i.PluginKey("mathematics"),state:{init:()=>o.DecorationSet.empty,apply(e,i,a,r){const{selection:p}=r,c=[];return r.doc.descendants(((e,i)=>{if(e.isText&&e.text){let a;for(;a=t.exec(e.text);){const e=i+a.index,t=e+a[0].length,r=a[1];if(r){const i=p.$from.pos-p.$to.pos,a=p.$anchor.pos>=e&&p.$anchor.pos<=t,d=p.$from.pos>=e&&p.$to.pos<=t,u=0===i&&a||d;u||c.push(o.Decoration.widget(e,(()=>{const e=document.createElement("span");e.classList.add("Tiptap-mathematics-render");try{s.default.render(r,e,n)}catch(t){e.innerHTML=r}return e}))),c.push(o.Decoration.inline(e,t,{class:u?"Tiptap-mathematics-editor":"Tiptap-mathematics-editor Tiptap-mathematics-editor--hidden",style:u?void 0:"display: inline-block; height: 0; opacity: 0; overflow: hidden; position: absolute; width: 0;"}))}}}})),c.length>0?o.DecorationSet.create(r.doc,c):o.DecorationSet.empty}},props:{decorations(e){return this.getState(e)}}})},p=t.Extension.create({name:"Mathematics",addOptions:()=>({regex:/\$([^\$]*)\$/gi,katexOptions:void 0}),addProseMirrorPlugins(){return[r(this.options)]}});e.Mathematics=p,e.MathematicsPlugin=r,e.default=p,Object.defineProperty(e,"__esModule",{value:!0})}));
